# ðŸ‡ºðŸ‡¸ Login Application API

This application is an authentication API for user management with password recovery via email, built using Spring Boot and JWT for authentication. Its goal is to provide a secure system for user registration, login, password recovery, and reset.

## Features

- User registration with email and password validation
- Login with JWT authentication
- Password recovery with email link delivery
- Password reset via link with a temporary token
- Field validation and error handling

## Technologies and Dependencies

- **Java 17**
- **Spring Boot 3** (Spring Security, Spring Data JPA, Spring Mail)
- **PostgreSQL** (relational database)
- **JWT** for authentication
- **Mailtrap** (for email testing)
- **BCrypt** for password hashing
- **Maven** for dependency management

## Project Structure

```plaintext
login_app/
â”œâ”€â”€ .mvn/                       # Maven folder (Maven configurations)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ dev/
â”‚   â”‚   â”‚       â””â”€â”€ mspilari/
â”‚   â”‚   â”‚           â””â”€â”€ login_app/
â”‚   â”‚   â”‚               â”œâ”€â”€ configs/           # Security, authentication, etc., configurations
â”‚   â”‚   â”‚               â”œâ”€â”€ domains/           # Application's main domains
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ email/         # Email-related logic
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ user/          # User-related logic
â”‚   â”‚   â”‚               â”œâ”€â”€ exceptions/        # Custom exceptions and error handling
â”‚   â”‚   â”‚               â””â”€â”€ utils/             # Utilities and helpers
â”‚   â”‚   â””â”€â”€ resources/                         # Resources (e.g., configuration files)
â”‚   â””â”€â”€ test/                                  # Application tests
â”œâ”€â”€ target/                                    # Compilation output folder generated by Maven
â”œâ”€â”€ .gitattributes                             # Git attributes configuration
â”œâ”€â”€ .gitignore                                 # Git ignore file
â”œâ”€â”€ docker-compose.yaml                        # Docker Compose configuration
â”œâ”€â”€ HELP.md                                    # Project help documentation
â”œâ”€â”€ mvnw                                       # Maven Wrapper script for Linux
â”œâ”€â”€ mvnw.cmd                                   # Maven Wrapper script for Windows
â””â”€â”€ pom.xml                                    # Maven configuration file
```

### Main Folder Descriptions

- **`configs/`**: Contains project configurations, likely related to security (e.g., JWT, authentication).
- **`domains/`**: Application domain logic, including classes for `email` and `user` functionalities.
- **`exceptions/`**: Handles custom exceptions for better error management.
- **`utils/`**: General utilities to support various functionalities.

## Prerequisites

- **Java 17+**
- **PostgreSQL** (create a database for the application and configure credentials in `application.properties`)
- **Mailtrap** for capturing emails in the development environment (or another SMTP service)

## Configuration

### Database

Configure your database credentials in the `application.properties` file:

```properties
spring.datasource.url=jdbc:postgresql://localhost:5432/<DATABASE_NAME>
spring.datasource.username=<USERNAME>
spring.datasource.password=<PASSWORD>
```

### SMTP (Mailtrap)

Set your Mailtrap or other SMTP service credentials in the `env.properties` file:

```properties
spring.mail.username=<MAILTRAP_USERNAME>
spring.mail.password=<MAILTRAP_PASSWORD>
```

**Note:** The `env.properties` file is imported in `application.properties` using the line `spring.config.import=classpath:env.properties`.

### JWT

JWT public and private keys are loaded in `application.properties`. Place your keys in the `resources` folder as `public.key` and `private.key`, and configure the properties:

```properties
jwt.public.key=classpath:public.key
jwt.private.key=classpath:private.key
```

### Expiration Settings

Define the expiration time for the JWT token and the password reset token (in seconds):

```properties
jwt.expiration=300
token.expiration.seconds=300
```

## Running the Project

1. Clone the repository:

   ```bash
   git clone https://github.com/MSpilari/spring_login.git
   cd login_app
   ```

2. Compile and run the application with Maven:

   ```bash
   ./mvnw spring-boot:run
   ```

3. The application will be available at `http://localhost:8080`.

## API Endpoints

### Authentication

- **POST** `/user/register`: Creates a new user. **Body:** `{ "email": "user@example.com", "password": "password" }`
- **POST** `/user/login`: Logs in and returns a JWT token. **Body:** `{ "email": "user@example.com", "password": "password" }`

### Password Recovery

- **POST** `/user/redeem-password`: Sends an email for password reset. **Body:** `{ "email": "user@example.com" }`
- **POST** `/user/reset-password`: Resets the password using a reset token. **Body:** `{ "token": "reset_token", "password": "newPassword" }`

### Example Responses

- **Success**

  ```json
  { "message": "User created successfully" }
  ```

- **Error**
  ```json
  {
    "errorMessage": "Invalid login credentials",
    "errorStatusCode": "400 BAD_REQUEST"
  }
  ```

## Exceptions and Error Handling

The system handles specific exceptions for validation and authentication, providing user-friendly messages with the appropriate HTTP status code.

## Future Improvements

- Implementation of differentiated roles and more granular access permissions
- Detailed logging for auditing and security analysis
- Integration with a secret management system for sensitive variables in production

## Contribution

Contributions are welcome! Follow the steps for creating pull requests and review.

---

# ðŸ‡§ðŸ‡· Login Application API

Esta aplicaÃ§Ã£o Ã© uma API de autenticaÃ§Ã£o para gerenciamento de usuÃ¡rios com recuperaÃ§Ã£o de senha via email, utilizando Spring Boot e JWT para autenticaÃ§Ã£o. O objetivo Ã© fornecer um sistema seguro de registro, login, recuperaÃ§Ã£o e redefiniÃ§Ã£o de senha.

## Funcionalidades

- Registro de usuÃ¡rios com validaÃ§Ã£o de email e senha
- Login com autenticaÃ§Ã£o JWT
- RecuperaÃ§Ã£o de senha com envio de link por email
- RedefiniÃ§Ã£o de senha via link com token temporÃ¡rio
- ValidaÃ§Ã£o de campos e manipulaÃ§Ã£o de erros

## Tecnologias e DependÃªncias

- **Java 17**
- **Spring Boot 3** (Spring Security, Spring Data JPA, Spring Mail)
- **PostgreSQL** (banco de dados relacional)
- **JWT** para autenticaÃ§Ã£o
- **Mailtrap** (para simulaÃ§Ã£o de envio de emails)
- **BCrypt** para hashing de senhas
- **Maven** para gerenciamento de dependÃªncias

## Estrutura do Projeto

```plaintext
login_app/
â”œâ”€â”€ .mvn/                       # Pasta do Maven (configuraÃ§Ãµes do Maven)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ dev/
â”‚   â”‚   â”‚       â””â”€â”€ mspilari/
â”‚   â”‚   â”‚           â””â”€â”€ login_app/
â”‚   â”‚   â”‚               â”œâ”€â”€ configs/           # ConfiguraÃ§Ãµes de seguranÃ§a, autenticaÃ§Ã£o, etc.
â”‚   â”‚   â”‚               â”œâ”€â”€ domains/           # DomÃ­nios principais da aplicaÃ§Ã£o
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ email/         # LÃ³gica relacionada a email
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ user/          # LÃ³gica relacionada ao usuÃ¡rio
â”‚   â”‚   â”‚               â”œâ”€â”€ exceptions/        # ExceÃ§Ãµes personalizadas e tratamento de erros
â”‚   â”‚   â”‚               â””â”€â”€ utils/             # UtilitÃ¡rios e helpers
â”‚   â”‚   â””â”€â”€ resources/                         # Recursos (ex: arquivos de configuraÃ§Ã£o)
â”‚   â””â”€â”€ test/                                  # Testes da aplicaÃ§Ã£o
â”œâ”€â”€ target/                                    # Pasta de compilaÃ§Ã£o gerada pelo Maven
â”œâ”€â”€ .gitattributes                             # ConfiguraÃ§Ãµes de atributos Git
â”œâ”€â”€ .gitignore                                 # Arquivo para ignorar arquivos no Git
â”œâ”€â”€ docker-compose.yaml                        # ConfiguraÃ§Ã£o Docker Compose
â”œâ”€â”€ HELP.md                                    # DocumentaÃ§Ã£o de ajuda do projeto
â”œâ”€â”€ mvnw                                       # Script Maven Wrapper para Linux
â”œâ”€â”€ mvnw.cmd                                   # Script Maven Wrapper para Windows
â””â”€â”€ pom.xml                                    # Arquivo de configuraÃ§Ã£o Maven
```

### DescriÃ§Ã£o das Pastas Principais

- **`configs/`**: ContÃ©m configuraÃ§Ãµes do projeto, provavelmente relacionadas Ã  seguranÃ§a (ex.: JWT, autenticaÃ§Ã£o).
- **`domains/`**: Estrutura de domÃ­nio da aplicaÃ§Ã£o, onde estÃ£o as classes e lÃ³gicas especÃ­ficas para `email` e `user` (usuÃ¡rio).
- **`exceptions/`**: ContÃ©m classes para tratamento de exceÃ§Ãµes personalizadas, melhorando o controle de erros.
- **`utils/`**: UtilitÃ¡rios gerais que auxiliam em diversas funcionalidades.

## PrÃ©-requisitos

- **Java 17+**
- **PostgreSQL** (crie um banco de dados para a aplicaÃ§Ã£o e configure as credenciais em `application.properties`)
- **Mailtrap** para captura de emails em ambiente de desenvolvimento (ou outro serviÃ§o SMTP)

## ConfiguraÃ§Ã£o

### Banco de Dados

Configure as credenciais do banco de dados no arquivo `application.properties`:

```properties
spring.datasource.url=jdbc:postgresql://localhost:5432/<NOME_DO_BANCO>
spring.datasource.username=<USUARIO>
spring.datasource.password=<SENHA>
```

### SMTP (Mailtrap)

Utilize suas credenciais do Mailtrap ou outro serviÃ§o de SMTP no arquivo `env.properties`:

```properties
spring.mail.username=<USUARIO_MAILTRAP>
spring.mail.password=<SENHA_MAILTRAP>
```

**Obs:** `env.properties` Ã© importado no `application.properties` com a linha `spring.config.import=classpath:env.properties`.

### JWT

As chaves pÃºblicas e privadas do JWT sÃ£o carregadas no `application.properties`. Coloque suas chaves nos arquivos `public.key` e `private.key` na pasta `resources`, e assegure-se de configurar as propriedades:

```properties
jwt.public.key=classpath:public.key
jwt.private.key=classpath:private.key
```

### ConfiguraÃ§Ã£o do Tempo de ExpiraÃ§Ã£o

Defina o tempo de expiraÃ§Ã£o do token JWT e o tempo de expiraÃ§Ã£o do token de redefiniÃ§Ã£o de senha (em segundos):

```properties
jwt.expiration=300
token.expiration.seconds=300
```

## Executando o Projeto

1. Clone o repositÃ³rio:

   ```bash
   git clone https://github.com/MSpilari/spring_login.git
   cd login_app
   ```

2. Compile e execute a aplicaÃ§Ã£o com o Maven:

   ```bash
   ./mvnw spring-boot:run
   ```

3. A aplicaÃ§Ã£o estarÃ¡ disponÃ­vel em `http://localhost:8080`.

## Endpoints da API

### AutenticaÃ§Ã£o

- **POST** `/user/register`: Cria um novo usuÃ¡rio. **Corpo:** `{ "email": "user@example.com", "password": "password" }`
- **POST** `/user/login`: Faz login e retorna um token JWT. **Corpo:** `{ "email": "user@example.com", "password": "password" }`

### RecuperaÃ§Ã£o de Senha

- **POST** `/user/redeem-password`: Envia um email para redefiniÃ§Ã£o de senha. **Corpo:** `{ "email": "user@example.com" }`
- **POST** `/user/reset-password`: Redefine a senha com base em um token de redefiniÃ§Ã£o. **Corpo:** `{ "token": "token_redefinicao", "password": "novaSenha" }`

### Exemplo de Respostas

- **Sucesso**

  ```json
  { "message": "User created successfully" }
  ```

- **Erro**
  ```json
  {
    "errorMessage": "Invalid login credentials",
    "errorStatusCode": "400 BAD_REQUEST"
  }
  ```

## ExceÃ§Ãµes e Tratamento de Erros

O sistema lida com exceÃ§Ãµes especÃ­ficas para validaÃ§Ã£o e autenticaÃ§Ã£o, lanÃ§ando mensagens amigÃ¡veis com o cÃ³digo de status HTTP correspondente.

## Melhorias Futuras

- ImplementaÃ§Ã£o de roles diferenciadas e permissÃµes de acesso mais granulares
- Logging detalhado para auditoria e anÃ¡lise de seguranÃ§a
- IntegraÃ§Ã£o com um sistema de gerenciamento de segredos para variÃ¡veis sensÃ­veis em produÃ§Ã£o

## ContribuiÃ§Ã£o

ContribuiÃ§Ãµes sÃ£o bem-vindas! Siga os passos para criaÃ§Ã£o de pull requests e revisÃ£o.
